<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Queries</title>
    <link rel="stylesheet" href="./styles.css">
</head>

<body>
    <div class="container">
        <h1>SQL Queries - Guest House Booking System</h1>

        <!-- query 1 -->
        <div class="question-container">
            <div class="question" onclick="toggleButton(this)">
                <div>
                    1. Find out the total income from booking for "Grand" hotel for current month.
                </div>
                <div class="icon" id="toggleBtn">+</div>
            </div>
            <div class="answer">
                <pre>
                SELECT SUM(r.rate) AS total_income
                FROM booking bk
                JOIN room r ON bk.room_no = r.room_no
                JOIN hotel h ON bk.hno = h.hno
                WHERE h.hname = 'Grand' AND 
                MONTH(bk.checkin_date) = MONTH(CURDATE()) 
                AND MONTH(bk.checkout_date) = MONTH(CURDATE());
                </pre>
                <img src="./images/02a.jpg" alt="solution 1">
            </div>
        </div>

        <!-- query 2 -->
        <div class="question-container">
            <div class="question" onclick="toggleButton(this)">
                <div>
                    2. Find how many different guest have made booking for August 2023.
                </div>
                <div class="icon" id="toggleBtn">+</div>
            </div>
            <div class="answer">
                <pre>
                    SELECT COUNT(DISTINCT(g.gname)) AS total_guest_aug2023
                    FROM booking bk
                    JOIN guest g ON bk.gno = g.gno
                    WHERE MONTH(bk.checkin_date) = 8 
                    AND YEAR(bk.checkin_date) = 2023;
                </pre>
                <img src="./images/02b.jpg" alt="solution 2">
            </div>
        </div>

        <!-- query 3 -->
        <div class="question-container">
            <div class="question" onclick="toggleButton(this)">
                <div>
                    3. Find how many guest books Double_AC room by today.
                </div>
                <div class="icon" class="toggleBtn">+</div>
            </div>
            <div class="answer">
                <pre>
                SELECT COUNT(*) AS total_guest_double_ac
                FROM booking bk
                JOIN room r ON bk.room_no = r.room_no
                JOIN guest g ON bk.gno = g.gno
                WHERE r.room_type = 'Double_AC' 
                AND bk.checkin_date = '2023-01-09';
                </pre>
                <img src="./images/02c.jpg" alt="solution 3">
            </div>
        </div>

        <!-- query 4 -->
        <div class="question-container">
            <div class="question" onclick="toggleButton(this)">
                <div>
                    4. Find name of the guest, citys and hotels booked with same city.
                </div>
                <div class="icon" class="toggleBtn">+</div>
            </div>
            <div class="answer">
                <pre>
                SELECT g.gname AS "Guest", g.gcity AS "City", hname AS "Hotel"
                FROM booking bk
                JOIN guest g ON bk.gno = g.gno
                JOIN hotel h ON bk.hno = h.hno
                WHERE g.gcity = h.city;
                </pre>
                <img src="./images/02d.jpg" alt="solution 4">
            </div>
        </div>

        <!-- query 5 -->
        <div class="question-container">
            <div class="question" onclick="toggleButton(this)">
                <div>
                    5. Find maximum room no booked till now.
                </div>
                <div class="icon" class="toggleBtn">+</div>
            </div>
            <div class="answer">
                <pre>
                WITH room_count AS
                (
                    SELECT room_no, COUNT(room_no) AS total
                    FROM booking
                    GROUP BY room_no
                )
                SELECT room_no
                FROM room_count
                JOIN (
                    SELECT MAX(total) AS Y
                    FROM room_count
                ) tb2 ON room_count.total = tb2.y
                </pre>
                <img src="./images/02e.jpg" alt="solution 5">
            </div>
        </div>

        <script>
            function toggleButton(element) {
                var answer = element.nextElementSibling;
                var btn = element.children[1];
                btn.innerText = (btn.innerText === '+' ? '-' : '+');
                if (answer.style.display === 'block') {
                    answer.style.display = 'none'
                } else {
                    answer.style.display = 'block'
                }
            }
        </script>
</body>

</html>